<!DOCTYPE html>
<head>

<!-- Basic Page Needs
================================================== -->
<title>Rentmatics</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<!-- CSS
================================================== -->
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/colors/main.css" id="colors">
<script type="text/javascript" src="scripts/jquery.min.js"></script>
<script type="text/javascript" src="scripts/jquery.cookie.min.js"></script>
<script>
var loginidd="";
var Apiprefixlogout="http://paymyhire.com:8083/Logout"
var Apiprefixchangepass="http://paymyhire.com:8083/Changepassword"
var ApiLogin ="http://paymyhire.com:8083/Login"
var ApiUser="http://paymyhire.com:8083/User"
var ApiForgotpassword="http://paymyhire.com:8083/Forgotpassword"


var cooki=$.cookie('RentmaticsCookie');
$(document).ready(function(){
 if(cooki==""||cooki==null||cooki==undefined||cooki=="NODATA"){
  
   }else{
       $("#login").html("MyAccount");
                document.getElementById("loginhiden").style.display = "none";
                document.getElementById("account").style.display = "inline";
    }
});
var check = function() {
	

  if (document.getElementById('password').value == document.getElementById('confirmpassword').value) {
    document.getElementById('message').style.color = 'green';
    document.getElementById('message').innerHTML = 'matching';
  } else {
    document.getElementById('message').style.color = 'red';
    document.getElementById('message').innerHTML = 'not matching';
  }
}

function setCookie(cname, cvalue, exdays) { 
  
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires="+ d.toUTCString();
    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}
//Logout the User
function logout() {
       setCookie("RentmaticsCookie", "NODATA",365) 
        location.reload(true);


}

function Payalert(){
	window.open("http://paymyhire.com/");

}

function changepassword(){


   
    var  changeoldpass=  document.getElementById('changeold').value
    var changenewpass =  document.getElementById('changenew').value;
    
     

    var s ={
      "Loginid":cooki,
      "OldPassword":changeoldpass,
      "Newpassword":changenewpass,
      
     };
    
$.ajax({
      type: "POST",
      url: Apiprefixchangepass,
      contentType:"application/json; charset=utf-8",
      data: JSON.stringify(s),

  success: function(responsee){
    Changeresponse = JSON.parse(responsee);
            
   

    if(Changeresponse == "success"){
    	alert("Password Successfully Updated")
        window.history.back()
    }else{
    	alert("Incorrect Current password")

    }
    

   
 
 }

});


}


var loginidvalue =""
 loginidvalue = localStorage.getItem("LoginID");

//Login
function Login() {
    var loginuser = document.getElementById('uname').value;
    var loginpass = document.getElementById('upass').value;
    var Rentmatics = {
        "Username": loginuser,
        "Password": loginpass,


    };


    $.ajax({
        type: "POST",
        url: ApiLogin,
        crossDomain: true,
       
        contentType: "application/json; charset=utf-8",
       
        data: JSON.stringify(Rentmatics),

        success: function(responsee,stat,xhr) {
            var searchout = JSON.parse(responsee);
           
            if (searchout.Status == "Success") {
                loginidd = searchout.Loginid;
                setCookie("RentmaticsCookie",searchout.Loginid,365) 
                $("#login").html("MyAccount");
                document.getElementById("loginhiden").style.display = "none";
                document.getElementById("account").style.visibility = "visible";
                 location.reload(true);
//alert(xhr.getResponseHeader('Set-Cookie'));
              
            } else {
                alert("Incorect Username and Password")

            } }
    });

}





// Signup-Register the Rentmatics user
function SignupRent() {
    var signuser = document.getElementById('Susername').value;
    var signpass = document.getElementById('cpassword').value;
    var signemail = document.getElementById('Semail').value;
    var Rentmatics = {
        "Id ": "",
        "Username": signuser,
        "Password": signpass,
        "Loginid": signemail,
        "Logintype": "Rentmatics"

    };


    $.ajax({
        type: "POST",
        url: ApiUser,
        xhrFields: {
       withCredentials: true
    },

        contentType: "application/json; charset=utf-8",
        data: JSON.stringify(Rentmatics),

        success: function(responsee) {
            var searchout = JSON.parse(responsee);
            var uservalue = searchout.Username;
            loginidd = searchout.Loginid;
            setCookie("RentmaticsCookie",searchout.Loginid,365) 
            $("#login").html(loginidd);
            
            document.getElementById("loginhiden").style.display = "none";
            document.getElementById("account").style.visibility = "visible";
             location.reload(true);
           
        }
    });
}



//For Google User-Signin
var auth2; // The Sign-In object.
var googleUser; // The current user.
var appStart = function() {
    gapi.load('auth2', initSigninV2);
};
var initSigninV2 = function() {
    auth2 = gapi.auth2.init({
        client_id: 'CLIENT_ID.apps.googleusercontent.com',
        scope: 'profile'
    });


    auth2.isSignedIn.listen(signinChanged);
    auth2.currentUser.listen(userChanged);

    if (auth2.isSignedIn.get() == true) {
        auth2.signIn();
    }
    refreshValues();
};


var signinChanged = function(val) {
    console.log('Signin state changed to ', val);

};

var userChanged = function(user) {
    console.log('User now: ', user);
    googleUser = user;
    updateGoogleUser();

};


var updateGoogleUser = function() {
    if (googleUser) {
        console.log("got google user");
        console.log(googleUser)

    } else {
        console.log("did nit get google user");

    }
};


var refreshValues = function() {
    if (auth2) {
        console.log('Refreshing values...');

        googleUser = auth2.currentUser.get();
        console.log(googleUser)
        updateGoogleUser();
    }
}

function GsignOut() {
    var auth2 = gapi.auth2.getAuthInstance();
    auth2.signOut().then(function() {
        console.log('User signed out.');

    });
}



var delete_cookie = function(name) {
    document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:01 GMT;';
};
var email = "";

function onSignIn(googleUser) {
    
    var profile = googleUser.getBasicProfile();
    console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
    console.log('Name: ' + profile.getName());
    console.log('Image URL: ' + profile.getImageUrl());
    console.log('Email: ' + profile.getEmail());

    // This is null if the 'email' scope is not present.

    var Id = profile.getId(); // Do not send to your backend! Use an ID token instead.
    var name = profile.getName();
    // var iamprofile.getImageUrl());
    email = profile.getEmail();



    var Gmail = {
        "Id ": Id,
        "Username": name,
        "Password": "",
        "Loginid": email,
        "Logintype": "Gmail"

    };


    $.ajax({
        type: "POST",
        url: ApiUser,
        contentType: "application/json; charset=utf-8",
        data: JSON.stringify(Gmail),

        success: function(responsee) {
                   var searchout = JSON.parse(responsee);
            var uservalue = searchout.Username;
            loginidd = searchout.Loginid;
            setCookie("RentmaticsCookie",searchout.Loginid,365) 
            $("#login").html(loginidd);
            
            document.getElementById("loginhiden").style.display = "none";
            document.getElementById("account").style.visibility = "visible";
          



        }

    });
}


  function signOut() {
             var auth2 = gapi.auth2.getAuthInstance();
             auth2.signOut().then(function () {
           console.log('User signed out.');
                  });
                }




            
           window.fbAsyncInit = function() {
             FB.init({
               appId      : '151850542086031',
               xfbml      : true,
               version    : 'v2.9'
             });
             FB.AppEvents.logPageView();
           };
         
           (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = 'https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.10&appId=151850542086031';
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
         
          // This is called with the results from from FB.getLoginStatus().
           function statusChangeCallback(response) {
             console.log('statusChangeCallback');
             console.log(response);
            
             if (response.status === 'connected') {
               // Logged into your app and Facebook.
               testAPI();
             } else {
             
               
             }
           }
         
           function checkLoginState() {
             FB.getLoginStatus(function(response) {
               statusChangeCallback(response);
             });
           }
         
         
           function testAPI() {
             console.log('Welcome!  Fetching your information.... ');
             FB.api('/me', function(response) {
               console.log('Successful login for: ' + response.name);
               console.log(response);
               // document.getElementById('status').innerHTML =
               //   'Thanks for logging in, ' + response.name + '!';


    var Facebook = {
        "Id ": "",
        "Username":response.name,
        "Password": "",
        "Loginid": response.name,
        "Logintype": "Facebook"

    };
   $.ajax({
        type: "POST",
        url: ApiUser,
        contentType: "application/json; charset=utf-8",
        data: JSON.stringify(Facebook),

        success: function(responsee) {
            var searchout = JSON.parse(responsee);
            var uservalue = searchout.Username;
            loginidd = searchout.Loginid;
            setCookie("RentmaticsCookie",searchout.Loginid,365) 
            $("#login").html(loginidd);
            document.getElementById("loginhiden").style.display = "none";
            document.getElementById("account").style.visibility = "visible";
           
   }
 });
 });
   }

</script>

</head>

<body>

<!-- Wrapper -->
<div id="wrapper">

<!-- Header Container
================================================== -->
<header id="header-container" class="fixed fullwidth dashboard">

	<!-- Header -->
	<div id="header" class="not-sticky">
		<div class="container">
			
			<!-- Left Side Content -->
			<div class="left-side">
				
				<!-- Logo -->
				<div id="logo">
					<a href="index.html"><img src="images/logo1.png" alt=""></a>
					<a href="index.html" class="dashboard-logo"><img src="images/logo2.png" alt=""></a>
				</div>

				<!-- Mobile Navigation -->
				<div class="mmenu-trigger">
					<button class="hamburger hamburger--collapse" type="button">
						<span class="hamburger-box">
							<span class="hamburger-inner"></span>
						</span>
					</button>
				</div>

				<!-- Main Navigation -->
				  <nav id="navigation" class="style-1">
          <ul id="responsive">

            <li><a class="current" href="index.html">Home</a></li>
                        <li><a href="howitwork.html">How It Works </a>
                <ul>
                <li><a href="owner.html">Owners</a> </li>
                <li><a href="tenats.html">Tenants</a></li>
                
                </ul>
            </li>
                        <li><a href="findamate.html">Find a mate</a></li>
                        <li><a href="http://paymyhire.com/" target="_blank" >PayMyHire</a></li>
                          
                         <li style="display:none" id="account"><a href="#">Hi Rentiees</a>
                  <ul>
                    <li><a href="dashboard-my-profile.html" >My Profile</a></li>
                    <li><a href="dashboard-bookmarks.html">My Wish List</a></li>
                    <li><a href="javascript:logout()" ">Logout</a></li>
                  
                  </ul> 
            </li>

          

              <li><a href="#sign-in-dialog" class="sign-in popup-with-zoom-anim"  id="loginhiden"><i class="sl sl-icon-login"></i>Sign In</a></li>

          <a href="listings-half-screen-map-list.html" class="button border with-icon">Explore Homes <i class="sl sl-icon-home"></i></a>    
          </ul>
           
        </nav>
				<div class="clearfix"></div>
				<!-- Main Navigation / End -->
				
			</div>
			<!-- Left Side Content / End -->

			
		</div>
	</div>
	<!-- Header / End -->

</header>
<div class="clearfix"></div>
<!-- Header Container / End -->


<!-- Dashboard -->
<div id="dashboard">

	<!-- Navigation
	================================================== -->

	<!-- Responsive Navigation Trigger -->
	<a href="#" class="dashboard-responsive-nav-trigger"><i class="fa fa-reorder"></i> Dashboard Navigation</a>
	
	<div class="dashboard-nav">
		<div class="dashboard-nav-inner">

		
			
			<ul data-submenu-title="Listings">
				
			
				<li><a href="dashboard-bookmarks.html"><i class="sl sl-icon-heart"></i> Bookmarks</a></li>
				<li><a href="changepassword.html"><i class="sl sl-icon-plus"></i> Change Password</a></li>
			</ul>	

			<ul data-submenu-title="Account">
				<li class="active"><a href="dashboard-my-profile.html"><i class="sl sl-icon-user"></i> My Profile</a></li>
				<li><a href="javascript:logout()"><i class="sl sl-icon-power"></i>Logout</a></li>
			</ul>

	</div>
	</div>
	<!-- Navigation / End -->


	<!-- Content
	================================================== -->
	<div class="dashboard-content">

		

          <form action="" method="post" onsubmit="changepassword();return false;" >

			<!-- Change Password -->
			<div class="col-lg-6 col-md-12">
				<div class="dashboard-list-box margin-top-0">
					<h4 class="gray">Change Password</h4>
					<div class="dashboard-list-box-static">

						<div class="my-profile">
							<label class="margin-top-0">Current Password</label>
							<input type="password" id="changeold" required="" >

							<label>New Password</label>
							<input type="password" required="">

							<label>Confirm New Password</label>
							<input type="password" id="changenew" required="">

							<button class="button margin-top-15">Change Password</button>
						</div>

					</div>
				</div>
			</div>
      </form>


			<!-- Copyrights -->
			<div class="col-md-12">
				<div class="copyrights">Â© 2017 Listeo. All Rights Reserved.</div>
			</div>

		</div>

	</div>
	<!-- Content / End -->


</div>
<!-- Dashboard / End -->


</div>
<!-- Wrapper / End -->


<!-- Scripts
================================================== -->
<script type="text/javascript" src="scripts/jquery-2.2.0.min.js"></script>
<script type="text/javascript" src="scripts/mmenu.min.js"></script>
<script type="text/javascript" src="scripts/chosen.min.js"></script>
<script type="text/javascript" src="scripts/slick.min.js"></script>
<script type="text/javascript" src="scripts/rangeslider.min.js"></script>
<script type="text/javascript" src="scripts/magnific-popup.min.js"></script>
<script type="text/javascript" src="scripts/waypoints.min.js"></script>
<script type="text/javascript" src="scripts/counterup.min.js"></script>
<script type="text/javascript" src="scripts/jquery-ui.min.js"></script>
<script type="text/javascript" src="scripts/tooltips.min.js"></script>
<script type="text/javascript" src="scripts/custom.js"></script>


</body>
</html>